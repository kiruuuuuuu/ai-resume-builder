<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{{ resume.profile.full_name }}'s Resume</title>
    <style type="text/css">
        @page {
            size: a4;
            margin: 1.5cm;
        }
        body {
            font-family: 'Helvetica', 'Arial', sans-serif;
            color: #333333;
            font-size: 10pt;
            line-height: 1.35; /* Tightened line height */
        }
        /* --- General Resets & Typography --- */
        p, h1, h2, h3, ul, li {
            margin: 0;
            padding: 0;
        }
        a {
            color: #3498db;
            text-decoration: none;
        }
        /* --- Header --- */
        .name {
            font-size: 24pt;
            font-weight: bold;
            text-align: center;
            color: #2c3e50;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .contact-info {
            text-align: center;
            font-size: 9.5pt;
            color: #555555;
            margin-top: 5px;
            margin-bottom: 15px; /* Reduced margin */
            border-bottom: 1px solid #cccccc;
            padding-bottom: 8px; /* Reduced padding */
        }
        .contact-info .separator { margin: 0 5px; }

        /* --- Sections & Items --- */
        .section-title {
            font-size: 13pt;
            font-weight: bold;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 4px;
            margin-top: 18px; /* Reduced margin */
            margin-bottom: 10px;
            text-transform: uppercase;
            page-break-after: avoid;
        }
        .section {
            margin-bottom: 10px; /* Reduced margin */
            page-break-inside: avoid;
        }
        .item {
            margin-bottom: 10px; /* Reduced margin */
            page-break-inside: avoid;
        }
        .item-header {
            overflow: auto; /* Clear floats */
            margin-bottom: 2px;
        }
        .title {
            font-weight: bold;
            font-size: 11pt;
        }
        .subtitle {
            font-style: italic;
            color: #444444;
        }
        .date {
            float: right;
            font-style: italic;
            font-size: 10pt;
        }

        /* --- Description Lists --- */
        .description-list {
            margin-top: 4px; /* Reduced margin */
            padding-left: 1.5em; 
            text-align: justify;
            list-style-position: outside;
        }
        .description-list li {
            margin-bottom: 3px; /* Reduced margin */
        }

        /* --- Other Lists & Details --- */
        .tech-details {
            font-size: 9.5pt;
            color: #444;
            margin-top: 4px;
        }
        .simple-list {
             padding-left: 1.5em;
             margin-top: 4px;
        }
        .simple-list li {
            margin-bottom: 3px;
        }
        .skill-category {
            font-weight: bold;
            font-size: 10.5pt;
        }
        .declaration {
            margin-top: 25px; /* Reduced margin */
            padding-top: 12px; /* Reduced padding */
            border-top: 1px solid #cccccc;
            font-size: 9pt;
            color: #555555;
            page-break-inside: avoid;
        }
    </style>
</head>
<body>

    <p class="name">{{ resume.profile.full_name|default:resume.profile.user.username }}</p>
    <div class="contact-info">
        {% if resume.profile.phone_number %}<a href="tel:{{ resume.profile.phone_number }}">{{ resume.profile.phone_number }}</a><span class="separator">|</span>{% endif %}
        <a href="mailto:{{ resume.profile.user.email }}">{{ resume.profile.user.email }}</a>
        {% if resume.profile.address %}<span class="separator">|</span>{{ resume.profile.address }}{% endif %}
        {% if resume.profile.portfolio_url %}<span class="separator">|</span><a href="{{ resume.profile.portfolio_url }}">Portfolio</a>{% endif %}
        {% if resume.profile.linkedin_url %}<span class="separator">|</span><a href="{{ resume.profile.linkedin_url }}">LinkedIn</a>{% endif %}
    </div>

    {% if resume.profile.professional_summary %}
    <div class="section">
        <h2 class="section-title">Summary</h2>
        <p style="text-align: justify;">{{ resume.profile.professional_summary|linebreaksbr }}</p>
    </div>
    {% endif %}

    {% if experiences %}
    <div class="section">
        <h2 class="section-title">Work Experience</h2>
        {% for exp in experiences %}
            <div class="item">
                <div class="item-header">
                    <span class="date">{{ exp.start_date|date:"M Y" }} - {% if exp.end_date %}{{ exp.end_date|date:"M Y" }}{% else %}Present{% endif %}</span>
                    <p class="title">{{ exp.job_title }}</p>
                </div>
                <p class="subtitle">{{ exp.company }}</p>
                {% if exp.description_points %}
                <ul class="description-list">
                    {% for point in exp.description_points %}
                        <li>{{ point }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>
        {% endfor %}
    </div>
    {% endif %}
    
    {% if educations %}
    <div class="section">
        <h2 class="section-title">Education</h2>
        {% for edu in educations %}
            <div class="item">
                <div class="item-header">
                    <span class="date">{{ edu.start_date|date:"M Y" }} - {% if edu.end_date %}{{ edu.end_date|date:"M Y" }}{% else %}Present{% endif %}</span>
                    <p class="title">{{ edu.degree }} in {{ edu.field_of_study }}</p>
                </div>
                <p class="subtitle">{{ edu.institution }}{% if edu.address %}, {{ edu.address }}{% endif %}</p>
                {% if edu.percentage %}<p style="margin-top: 2px; font-size: 10pt;"><strong>Grade/Percentage:</strong> {{ edu.percentage }}</p>{% endif %}
            </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if projects %}
    <div class="section">
        <h2 class="section-title">Projects</h2>
        {% for p in projects %}
            <div class="item">
                <p class="title">{{ p.title }}</p>
                {% if p.aim %}<p class="subtitle">{{ p.aim }}</p>{% endif %}
                 {% if p.description_points %}
                <ul class="description-list">
                    {% for point in p.description_points %}
                        <li>{{ point }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
                <div class="tech-details">
                    {% if p.frontend %}<strong>Frontend:</strong> {{ p.frontend }}<br>{% endif %}
                    {% if p.backend %}<strong>Backend:</strong> {{ p.backend }}<br>{% endif %}
                    {% if p.database %}<strong>Database:</strong> {{ p.database }}<br>{% endif %}
                    {% if p.link %}<strong>Link:</strong> <a href="{{ p.link }}">{{ p.link }}</a>{% endif %}
                </div>
            </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if skills_by_category %}
    <div class="section">
        <h2 class="section-title">Skills</h2>
        {% for category, skills in skills_by_category.items %}
            <p style="margin-bottom: 5px;"><strong class="skill-category">{{ category }}:</strong> {{ skills|join:", " }}</p>
        {% endfor %}
    </div>
    {% endif %}

    {% if certifications %}
    <div class="section">
        <h2 class="section-title">Certifications</h2>
        <ul class="simple-list">
        {% for cert in certifications %}
            <li><strong>{{ cert.name }}</strong> - <em>{{ cert.issuing_organization }}</em> {% if cert.date_issued %}({{ cert.date_issued|date:"M Y" }}){% endif %}</li>
        {% endfor %}
        </ul>
    </div>
    {% endif %}

    {% if achievements %}
    <div class="section">
        <h2 class="section-title">Achievements</h2>
        <ul class="simple-list">
        {% for a in achievements %}
            <li>{% if a.name %}<strong>{{ a.name }}:</strong> {% endif %}{{ a.description }}</li>
        {% endfor %}
        </ul>
    </div>
    {% endif %}

    {% if languages %}
    <div class="section">
        <h2 class="section-title">Languages</h2>
        <p>{% for lang in languages %}{{ lang.name }} ({{ lang.get_proficiency_display }}){% if not forloop.last %}, {% endif %}{% endfor %}</p>
    </div>
    {% endif %}

    {% if hobbies %}
    <div class="section">
        <h2 class="section-title">Hobbies</h2>
        <p>{{ hobbies|join:", " }}</p>
    </div>
    {% endif %}

    <div class="declaration">
        <p>I hereby declare that the information provided is true and correct to the best of my knowledge.</p>
        <p style="margin-top: 25px;">
            <strong>Date:</strong> {% now "F d, Y" %}
            <br><br>
            <strong>Signature:</strong>
            <br><br>
            _________________________
            <br>
            ({{ resume.profile.full_name }})
        </p>
    </div>

</body>
</html>

