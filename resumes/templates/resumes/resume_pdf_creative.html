<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{{ resume.profile.full_name }}'s Resume</title>
    <style type="text/css">
        @page {
            size: a4;
            margin: 0.5cm;
        }
        
        /* Page break styling */
        .page-break {
            page-break-after: always;
            break-after: page;
        }
        
        .no-page-break {
            page-break-inside: avoid;
            break-inside: avoid;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            color: #1a202c;
            font-size: 8.5pt; /* Reduced for single page */
            line-height: 1.3; /* Tighter */
            background-color: white;
            margin: 0;
            padding: 0;
        }
        
        .resume-container {
            background: white;
            padding: 8px; /* Reduced */
            max-width: 100%;
            position: relative;
            min-height: 287mm; /* A4 height minus margins - single page constraint */
            max-height: 287mm; /* Prevent overflow to second page */
            overflow: hidden; /* Prevent overflow */
        }
        
        /* Header - Ultra Compact */
        .header {
            background: linear-gradient(135deg, {{ accent_color|default:'#667eea' }} 0%, {{ accent_color|default:'#667eea' }}dd 100%);
            color: white;
            padding: 12px 18px; /* Reduced */
            margin: -8px -8px 6px -8px; /* Adjusted */
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            pointer-events: none;
        }
        
        .header-content {
            position: relative;
            z-index: 1;
        }
        
        .name {
            font-size: 20pt; /* Reduced */
            font-weight: 800;
            color: white;
            margin: 0 0 3px 0; /* Reduced */
            letter-spacing: 0.5px;
            text-transform: uppercase;
            line-height: 1.1;
        }
        
        .contact-info {
            font-size: 7.5pt; /* Reduced */
            color: rgba(255, 255, 255, 0.95);
        }
        
        .contact-info a {
            color: white;
            text-decoration: none;
            font-weight: 500;
        }
        
        /* Summary - Inline with header or very compact */
        .summary-section {
            margin-bottom: 5px; /* Reduced */
        }
        
        .summary {
            background: #f7fafc;
            padding: 6px 10px; /* Reduced */
            border-left: 3px solid {{ accent_color|default:'#667eea' }};
            border-radius: 3px;
            font-size: 8pt; /* Reduced */
            line-height: 1.3; /* Tighter */
        }
        
        /* Two-column layout using floats (PDF-friendly) */
        .two-column {
            width: 100%;
            overflow: hidden;
        }
        
        .column-left {
            width: 55%;
            float: left;
            padding-right: 10px;
            min-height: 1px; /* Prevent collapse */
        }
        
        .column-right {
            width: 45%;
            float: right;
            padding-left: 10px;
            min-height: 1px; /* Prevent collapse */
        }
        
        /* Balance columns - ensure right column content is distributed */
        .column-right .section:last-child {
            margin-bottom: 0;
        }
        
        .clearfix::after {
            content: "";
            display: table;
            clear: both;
        }
        
        /* Sections - Ultra Compact */
        .section {
            margin-bottom: 6px;
            page-break-inside: avoid;
        }
        
        .section-title {
            font-size: 10pt; /* Reduced */
            font-weight: 700;
            color: {{ accent_color|default:'#667eea' }};
            margin-bottom: 3px; /* Reduced */
            margin-top: 0;
            padding-bottom: 2px;
            border-bottom: 2px solid {{ accent_color|default:'#667eea' }};
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Experience & Education Items - Ultra Compact */
        .item {
            margin-bottom: 5px;
            padding: 6px 10px;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 3px solid {{ accent_color|default:'#667eea' }};
        }
        
        .item-header {
            margin-bottom: 4px;
        }
        
        .item-title-row {
            display: table;
            width: 100%;
        }
        
        .item-title-cell {
            display: table-cell;
            vertical-align: top;
        }
        
        .item-title {
            font-weight: 700;
            font-size: 9pt; /* Reduced */
            color: #1a202c;
            line-height: 1.2;
        }
        
        .item-subtitle {
            color: #4a5568;
            font-size: 8pt; /* Reduced */
            font-style: italic;
            margin-top: 1px;
        }
        
        .item-date {
            color: {{ accent_color|default:'#667eea' }};
            font-weight: 600;
            font-size: 7.5pt; /* Reduced */
            white-space: nowrap;
            text-align: right;
            display: table-cell;
            vertical-align: top;
            width: 30%;
        }
        
        .item-description {
            margin-top: 3px; /* Reduced */
            color: #2d3748;
            font-size: 8pt; /* Reduced */
        }
        
        .item-description ul {
            padding-left: 14px; /* Reduced */
            margin: 0;
        }
        
        .item-description li {
            margin-bottom: 1px; /* Reduced */
            line-height: 1.25; /* Tighter */
        }
        
        /* Skills - Table-based layout */
        .skills-container {
            width: 100%;
        }
        
        .skill-category {
            margin-bottom: 5px;
        }
        
        .skill-category:last-child {
            margin-bottom: 0;
        }
        
        .skill-category-title {
            font-weight: 700;
            color: #1a202c;
            font-size: 9pt;
            margin-bottom: 4px;
            padding-bottom: 2px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .skill-item {
            margin-bottom: 4px;
            display: table;
            width: 100%;
        }
        
        .skill-name {
            font-size: 8pt;
            color: #4a5568;
            width: 70px;
            display: table-cell;
            vertical-align: middle;
            font-weight: 500;
        }
        
        .skill-bar-container {
            display: table-cell;
            vertical-align: middle;
            width: auto;
            padding: 0 6px;
        }
        
        .skill-bar-wrapper {
            height: 6px;
            background: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
            width: 100%;
        }
        
        .skill-bar {
            height: 100%;
            background: {{ accent_color|default:'#667eea' }};
            border-radius: 3px;
        }
        
        .skill-level {
            font-size: 7.5pt;
            color: {{ accent_color|default:'#667eea' }};
            font-weight: 600;
            width: 35px;
            text-align: right;
            display: table-cell;
            vertical-align: middle;
        }
        
        /* Languages - Table-based */
        .languages-container {
            width: 100%;
        }
        
        .language-item {
            display: table;
            width: 100%;
            margin-bottom: 3px;
            padding: 4px 7px;
            background: #f8f9fa;
            border-radius: 3px;
        }
        
        .language-item:last-child {
            margin-bottom: 0;
        }
        
        .language-name {
            font-weight: 600;
            color: #1a202c;
            font-size: 8.5pt;
            width: 70px;
            display: table-cell;
            vertical-align: middle;
        }
        
        .proficiency-dots {
            display: table-cell;
            vertical-align: middle;
            padding: 0 5px;
        }
        
        .dot {
            display: inline-block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            margin-right: 3px;
        }
        
        .dot-filled {
            background: {{ accent_color|default:'#667eea' }};
        }
        
        .dot-empty {
            background: #e2e8f0;
            border: 1px solid #cbd5e0;
        }
        
        .proficiency-text {
            display: table-cell;
            vertical-align: middle;
            color: #718096;
            font-size: 7.5pt;
            text-align: right;
        }
        
        /* Projects - Compact */
        .project-item {
            margin-bottom: 5px;
            padding: 6px 10px;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 3px solid {{ accent_color|default:'#667eea' }};
        }
        
        .project-tech {
            margin-top: 4px;
            font-size: 8pt;
            color: #718096;
        }
        
        .project-tech strong {
            color: {{ accent_color|default:'#667eea' }};
            font-weight: 600;
        }
        
        .project-link {
            color: {{ accent_color|default:'#667eea' }};
            text-decoration: none;
            font-weight: 500;
        }
        
        /* Certifications & Achievements - Compact */
        .certs-container, .achievements-container {
            width: 100%;
        }
        
        .cert-item, .achieve-item {
            padding: 5px 8px;
            background: #f8f9fa;
            border-radius: 3px;
            border-left: 2px solid {{ accent_color|default:'#667eea' }};
            font-size: 8pt;
            line-height: 1.3;
            margin-bottom: 3px;
        }
        
        .cert-item:last-child, .achieve-item:last-child {
            margin-bottom: 0;
        }
        
        .cert-item strong, .achieve-item strong {
            color: {{ accent_color|default:'#667eea' }};
            font-weight: 600;
        }
        
        /* Hobbies - Compact Tags */
        .hobbies {
            line-height: 1.8;
        }
        
        .hobby-tag {
            display: inline-block;
            padding: 3px 8px;
            background: {{ accent_color|default:'#667eea' }};
            color: white;
            border-radius: 10px;
            font-size: 7.5pt;
            font-weight: 500;
            margin-right: 4px;
            margin-bottom: 3px;
        }
        
        /* Grade/Percentage styling */
        .grade-info {
            margin-top: 3px;
            color: #4a5568;
            font-size: 8pt;
        }
        
        .grade-info strong {
            color: {{ accent_color|default:'#667eea' }};
        }
        
        /* Print optimizations */
        @media print {
            .resume-container {
                padding: 0;
            }
            .section {
                page-break-inside: avoid;
            }
            .item {
                page-break-inside: avoid;
            }
            .two-column {
                overflow: visible;
            }
        }
    </style>
</head>
<body>
    <div class="resume-container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <p class="name">{{ resume.profile.full_name|default:resume.profile.user.username }}</p>
                <div class="contact-info">
                    {% if resume.profile.phone_number %}<a href="tel:{{ resume.profile.phone_number }}">{{ resume.profile.phone_number }}</a> | {% endif %}
                    <a href="mailto:{{ resume.profile.user.email }}">{{ resume.profile.user.email }}</a>
                    {% if resume.profile.address %} | {{ resume.profile.address }}{% endif %}
                    {% if resume.profile.portfolio_url %} | <a href="{{ resume.profile.portfolio_url }}">Portfolio</a>{% endif %}
                    {% if resume.profile.linkedin_url %} | <a href="{{ resume.profile.linkedin_url }}">LinkedIn</a>{% endif %}
                </div>
            </div>
        </div>

        <!-- Professional Summary - Compact -->
        {% if resume.profile.professional_summary %}
        <div class="summary-section">
            <div class="summary">
                {{ resume.profile.professional_summary|linebreaksbr }}
            </div>
        </div>
        {% endif %}

        <!-- Main Content: Two Column Layout using Floats -->
        <div class="two-column clearfix">
            <!-- Left Column -->
            <div class="column-left">
                <!-- Experience -->
                {% if experiences %}
                <div class="section">
                    <h2 class="section-title">Experience</h2>
                    {% for exp in experiences %}
                    <div class="item">
                        <div class="item-header">
                            <div class="item-title-row">
                                <div class="item-title-cell">
                                    <div class="item-title">{{ exp.job_title }}</div>
                                    <div class="item-subtitle">{{ exp.company }}{% if exp.location %}, {{ exp.location }}{% endif %}</div>
                                </div>
                                <div class="item-date">{{ exp.start_date|date:"M Y" }} - {% if exp.end_date %}{{ exp.end_date|date:"M Y" }}{% else %}Present{% endif %}</div>
                            </div>
                        </div>
                        {% if exp.description_points %}
                        <div class="item-description">
                            <ul>
                                {% for point in exp.description_points %}
                                <li>{{ point }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
                {% endif %}

                <!-- Education -->
                {% if educations %}
                <div class="section">
                    <h2 class="section-title">Education</h2>
                    {% for edu in educations %}
                    <div class="item">
                        <div class="item-header">
                            <div class="item-title-row">
                                <div class="item-title-cell">
                                    <div class="item-title">{{ edu.degree }}{% if edu.field_of_study %} in {{ edu.field_of_study }}{% endif %}</div>
                                    <div class="item-subtitle">{{ edu.institution }}{% if edu.address %}, {{ edu.address }}{% endif %}</div>
                                </div>
                                <div class="item-date">{{ edu.start_date|date:"M Y" }} - {% if edu.end_date %}{{ edu.end_date|date:"M Y" }}{% else %}Present{% endif %}</div>
                            </div>
                        </div>
                        {% if edu.percentage %}
                        <div class="grade-info">
                            <strong>Grade:</strong> {{ edu.percentage }}
                        </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
                {% endif %}

                <!-- Projects -->
                {% if projects %}
                <div class="section">
                    <h2 class="section-title">Projects</h2>
                    {% for p in projects %}
                    <div class="project-item">
                        <div class="item-title">{{ p.title }}</div>
                        {% if p.aim %}
                        <div class="item-subtitle" style="margin-top: 2px;">{{ p.aim }}</div>
                        {% endif %}
                        {% if p.description_points %}
                        <div class="item-description" style="margin-top: 4px;">
                            <ul>
                                {% for point in p.description_points %}
                                <li>{{ point }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endif %}
                        <div class="project-tech">
                            {% if p.frontend %}<strong>Frontend:</strong> {{ p.frontend }} | {% endif %}
                            {% if p.backend %}<strong>Backend:</strong> {{ p.backend }} | {% endif %}
                            {% if p.database %}<strong>Database:</strong> {{ p.database }}{% endif %}
                            {% if p.link %}<br><strong>Link:</strong> <a href="{{ p.link }}" class="project-link">{{ p.link }}</a>{% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
            </div>

            <!-- Right Column -->
            <div class="column-right">
                <!-- Skills -->
                {% if skills_by_category %}
                <div class="section">
                    <h2 class="section-title">Skills</h2>
                    <div class="skills-container">
                        {% for category, skills in skills_by_category.items %}
                        <div class="skill-category">
                            <div class="skill-category-title">{{ category }}</div>
                            {% for skill in skills %}
                            <div class="skill-item">
                                <span class="skill-name">{{ skill }}</span>
                                <span class="skill-bar-container">
                                    <div class="skill-bar-wrapper">
                                        <span class="skill-bar" style="width: {% cycle '85' '90' '75' '80' '95' '70' '88' '82' %}%;"></span>
                                    </div>
                                </span>
                                <span class="skill-level">{% cycle '85%' '90%' '75%' '80%' '95%' '70%' '88%' '82%' %}</span>
                            </div>
                            {% endfor %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- Languages -->
                {% if languages %}
                <div class="section">
                    <h2 class="section-title">Languages</h2>
                    <div class="languages-container">
                        {% for lang in languages %}
                        <div class="language-item">
                            <span class="language-name">{{ lang.name }}</span>
                            <span class="proficiency-dots">
                                {% if lang.proficiency == 'Fluent' %}
                                    <span class="dot dot-filled"></span><span class="dot dot-filled"></span><span class="dot dot-filled"></span><span class="dot dot-filled"></span><span class="dot dot-filled"></span>
                                {% elif lang.proficiency == 'Advanced' %}
                                    <span class="dot dot-filled"></span><span class="dot dot-filled"></span><span class="dot dot-filled"></span><span class="dot dot-filled"></span><span class="dot dot-empty"></span>
                                {% elif lang.proficiency == 'Intermediate' %}
                                    <span class="dot dot-filled"></span><span class="dot dot-filled"></span><span class="dot dot-filled"></span><span class="dot dot-empty"></span><span class="dot dot-empty"></span>
                                {% else %}
                                    <span class="dot dot-filled"></span><span class="dot dot-filled"></span><span class="dot dot-empty"></span><span class="dot dot-empty"></span><span class="dot dot-empty"></span>
                                {% endif %}
                            </span>
                            <span class="proficiency-text">({{ lang.get_proficiency_display }})</span>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- Certifications -->
                {% if certifications %}
                <div class="section">
                    <h2 class="section-title">Certifications</h2>
                    <div class="certs-container">
                        {% for cert in certifications %}
                        <div class="cert-item">
                            <strong>{{ cert.name }}</strong><br>
                            <em>{{ cert.issuing_organization }}</em>
                            {% if cert.date_issued %} ({{ cert.date_issued|date:"M Y" }}){% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- Achievements -->
                {% if achievements %}
                <div class="section">
                    <h2 class="section-title">Achievements</h2>
                    <div class="achievements-container">
                        {% for a in achievements %}
                        <div class="achieve-item">
                            {% if a.name %}<strong>{{ a.name }}:</strong> {% endif %}{{ a.description }}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- Hobbies -->
                {% if hobbies %}
                <div class="section">
                    <h2 class="section-title">Hobbies</h2>
                    <div class="hobbies">
                        {% for hobby in hobbies %}
                        <span class="hobby-tag">{{ hobby }}</span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</body>
</html>
