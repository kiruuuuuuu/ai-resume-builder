<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{{ resume.profile.full_name }}'s Resume</title>
    <style type="text/css">
        @page { 
            size: a4; 
            margin: 1.5cm; /* Standard margins */
        }
        
        body { 
            font-family: 'Helvetica', 'Arial', sans-serif; 
            color: #333; 
            font-size: 9.5pt;
            line-height: 1.4;
        }

        /* --- Header: Part of the normal document flow --- */
        .header {
            text-align: center;
            padding-bottom: 12px;
            border-bottom: 1.5px solid #003366;
        }
        .name { 
            font-size: 24pt;
            font-weight: bold;
            color: #003366;
            margin: 0;
            padding: 0;
            letter-spacing: 1px;
        }
        .contact-info {
            font-size: 9pt;
            color: #555;
            margin-top: 6px;
        }
        .contact-info a {
            color: #003366;
            text-decoration: none;
        }
        .contact-info .separator {
            margin: 0 6px;
        }

        /* --- Section Titles with Icons --- */
        .section {
            page-break-inside: avoid;
        }
        .section-header {
            display: flex;
            align-items: center;
            margin-top: 18px;
            margin-bottom: 10px;
            border-bottom: 1px solid #003366;
            padding-bottom: 4px;
            page-break-after: avoid;
        }
        .section-header svg {
            width: 14px;
            height: 14px;
            margin-right: 8px;
            color: #003366;
        }
        h2 {
            font-size: 11pt;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: #003366;
            margin: 0;
            padding: 0;
        }

        /* --- Item Styling with Enhanced Timeline --- */
        .timeline-item {
            margin-left: 10px;
            padding-left: 25px;
            border-left: 2px solid #e0e0e0;
            padding-bottom: 15px;
            position: relative;
            page-break-inside: avoid;
        }
        .timeline-item:last-child {
            padding-bottom: 5px;
            border-left: 2px solid transparent;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 5px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #fff;
            border: 2px solid #003366;
        }
        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 1px;
        }
        .title { 
            font-weight: bold; 
            font-size: 10.5pt; 
            color: #000;
        }
        .subtitle { 
            font-style: italic;
            font-size: 9.5pt;
            color: #555;
        }
        .date { 
            font-size: 9pt; 
            color: #333; 
            font-weight: bold;
        }
        .description { margin-top: 4px; }
        ul { padding-left: 16px; margin-top: 4px; }
        li { margin-bottom: 3px; text-align: justify; }

        /* --- Other Sections --- */
        .skills-container, .additional-info, .summary-text {
            padding: 0 8px;
        }
        .additional-info p, .summary-text { margin-bottom: 6px; text-align: justify; }
        
    </style>
</head>
<body>
    <div class="header">
        <div class="name">{{ resume.profile.full_name|default:resume.profile.user.username }}</div>
        <div class="contact-info">
            {% if resume.profile.phone_number %}
                <a href="tel:{{ resume.profile.phone_number }}">{{ resume.profile.phone_number }}</a>
                <span class="separator">|</span>
            {% endif %}
            <a href="mailto:{{ resume.profile.user.email }}">{{ resume.profile.user.email }}</a>
            {% if resume.profile.linkedin_url %}
                <span class="separator">|</span>
                <a href="{{ resume.profile.linkedin_url }}">LinkedIn</a>
            {% endif %}
            {% if resume.profile.portfolio_url %}
                <span class="separator">|</span>
                <a href="{{ resume.profile.portfolio_url }}">Portfolio</a>
            {% endif %}
            {% if resume.profile.address %}
                <span class="separator">|</span>
                {{ resume.profile.address }}
            {% endif %}
        </div>
    </div>

    {% if resume.profile.professional_summary %}
    <div class="section">
        <div class="section-header">
            <svg viewBox="0 0 20 20"><path fill="currentColor" d="M10 2a2 2 0 00-2 2v1a2 2 0 004 0V4a2 2 0 00-2-2zM5.44 10.22a4.5 4.5 0 004.56 4.56A4.5 4.5 0 0014.56 10.22L16 8.78V16a2 2 0 01-2 2H6a2 2 0 01-2-2V8.78l1.44 1.44zM10 9a3 3 0 100-6 3 3 0 000 6z"/></svg>
            <h2>Professional Summary</h2>
        </div>
        <p class="summary-text">{{ resume.profile.professional_summary|linebreaksbr }}</p>
    </div>
    {% endif %}

    {% if experiences %}
    <div class="section">
        <div class="section-header">
            <svg viewBox="0 0 20 20"><path fill="currentColor" d="M5.5 4.25a.75.75 0 01.75.75v10a.75.75 0 01-1.5 0V5a.75.75 0 01.75-.75zM14.5 4.25a.75.75 0 01.75.75v10a.75.75 0 01-1.5 0V5a.75.75 0 01.75-.75zM9 4a1 1 0 00-1 1v10a1 1 0 002 0V5a1 1 0 00-1-1z"/></svg>
            <h2>Professional Experience</h2>
        </div>
        {% for exp in experiences %}
            <div class="timeline-item">
                <div class="item-header">
                    <span class="title">{{ exp.job_title }}</span>
                    <span class="date">{{ exp.start_date|date:"M Y" }} - {% if exp.end_date %}{{ exp.end_date|date:"M Y" }}{% else %}Present{% endif %}</span>
                </div>
                <p class="subtitle">{{ exp.company }}</p>
                <div class="description">
                    <ul>
                    {% for line in exp.description_points %}
                        <li>{{ line }}</li>
                    {% endfor %}
                    </ul>
                </div>
            </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if educations %}
    <div class="section">
        <div class="section-header">
            <svg viewBox="0 0 20 20"><path fill="currentColor" d="M10.362 1.096a.75.75 0 00-1.224 0C7.22 3.12 5.33 4.23 4.03 5.91.43 8.36 1.18 12.56 3.4 14.78A13.6 13.6 0 0010 18.5a13.6 13.6 0 006.6-3.72c2.22-2.22 2.97-6.42.4-8.87-1.3-1.68-3.19-2.79-5.138-4.814zM9.25 12.31a.75.75 0 011.5 0v2.19a.75.75 0 01-1.5 0v-2.19zM10 5.75a.75.75 0 00-.75.75v2.5a.75.75 0 001.5 0v-2.5A.75.75 0 0010 5.75z"/></svg>
            <h2>Education</h2>
        </div>
        {% for edu in educations %}
            <div class="timeline-item">
               <div class="item-header">
                    <span class="title">{{ edu.degree }}</span>
                    <span class="date">{{ edu.start_date|date:"M Y" }} - {% if edu.end_date %}{{ edu.end_date|date:"M Y" }}{% else %}Present{% endif %}</span>
                </div>
                <p class="subtitle">{{ edu.institution }}{% if edu.address %}, {{ edu.address }}{% endif %}</p>
                {% if edu.percentage %}<p style="margin-top: 2px;"><strong>Grade/Percentage:</strong> {{ edu.percentage }}</p>{% endif %}
            </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if projects %}
    <div class="section">
        <div class="section-header">
            <svg viewBox="0 0 20 20"><path fill="currentColor" d="M12.25 3.125a.75.75 0 00-1.5 0v.375h-1.5V3.125a.75.75 0 00-1.5 0V5.25h4.5V3.125zM8.5 6.75v-.375a.75.75 0 00-1.5 0v.375h-3.25V5.625a.75.75 0 00-1.5 0v1.125H1.5A1.5 1.5 0 000 8.25v8A1.5 1.5 0 001.5 17.75h12A1.5 1.5 0 0015 16.25v-8A1.5 1.5 0 0013.5 6.75h-5z"/></svg>
            <h2>Projects</h2>
        </div>
        <div class="additional-info">
             <ul>
            {% for p in projects %}
                <li>
                    <strong>{{ p.title }}:</strong> {{ p.description }}
                    {% if p.frontend or p.backend or p.database %}
                        <br><em>Technologies: 
                        {% if p.frontend %}{{ p.frontend }}{% if p.backend or p.database %}, {% endif %}{% endif %}
                        {% if p.backend %}{{ p.backend }}{% if p.database %}, {% endif %}{% endif %}
                        {% if p.database %}{{ p.database }}{% endif %}
                        </em>
                    {% endif %}
                </li>
            {% endfor %}
            </ul>
        </div>
    </div>
    {% endif %}

    {% if skills_by_category %}
    <div class="section">
        <div class="section-header">
            <svg viewBox="0 0 20 20"><path fill="currentColor" d="M10 3.75a.75.75 0 01.75.75v10.5a.75.75 0 01-1.5 0V4.5a.75.75 0 01.75-.75zM5.5 6.75a.75.75 0 000 1.5h1.563l-3.031 6.82a.75.75 0 001.336.592L8.383 9.44A2.25 2.25 0 0110 8.25h.002a2.25 2.25 0 011.618 1.19l3.014 6.22a.75.75 0 101.336-.593L12.936 8.25H14.5a.75.75 0 000-1.5H5.5z"/></svg>
            <h2>Core Skills</h2>
        </div>
        <div class="skills-container">
        {% for category, skills in skills_by_category.items %}
            <p style="margin-bottom: 4px;"><strong>{{ category }}:</strong> {{ skills|join:", " }}</p>
        {% endfor %}
        </div>
    </div>
    {% endif %}

    {% if certifications %}
    <div class="section">
         <div class="section-header">
            <svg viewBox="0 0 20 20"><path fill="currentColor" d="M8.25 10.875a2.625 2.625 0 115.25 0 2.625 2.625 0 01-5.25 0z"/><path fill-rule="evenodd" d="M12 1.25a1 1 0 00-1-1H9a1 1 0 00-1 1v.342a4.985 4.985 0 00-2.31.266l-.73-.217a1 1 0 00-1.122.373L2.373 3.878a1 1 0 00.374 1.122l.217.73A4.985 4.985 0 001.592 8H1.25a1 1 0 00-1 1v2a1 1 0 001 1h.342a4.985 4.985 0 00.266 2.31l-.217.73a1 1 0 00.373 1.122l1.465 1.465a1 1 0 001.122.373l.73-.217c.69.53 1.472.93 2.31.266V18.75a1 1 0 001 1h2a1 1 0 001-1v-.342a4.985 4.985 0 002.31-.266l.73.217a1 1 0 001.122-.373l1.465-1.465a1 1 0 00-.373-1.122l-.217-.73a4.985 4.985 0 00.266-2.31H18.75a1 1 0 001-1V9a1 1 0 00-1-1h-.342a4.985 4.985 0 00-.266-2.31l.217-.73a1 1 0 00-.373-1.122l-1.465-1.465a1 1 0 00-1.122-.373l-.73.217A4.985 4.985 0 0012.408 2H12V1.25zM10 14a4 4 0 100-8 4 4 0 000 8z" clip-rule="evenodd"/></svg>
            <h2>Certifications</h2>
        </div>
        <div class="additional-info">
            <ul>
            {% for cert in certifications %}
                 <li><strong>{{ cert.name }}</strong> - <em>{{ cert.issuing_organization }}</em> {% if cert.date_issued %}({{ cert.date_issued|date:"M Y" }}){% endif %}</li>
            {% endfor %}
            </ul>
        </div>
    </div>
    {% endif %}

    {% if achievements %}
    <div class="section">
        <div class="section-header">
            <svg viewBox="0 0 20 20"><path fill="currentColor" fill-rule="evenodd" d="M15.5 4.925a3.5 3.5 0 10-7 0 3.5 3.5 0 007 0zM5.5 4.925a3.5 3.5 0 10-7 0 3.5 3.5 0 007 0zM8 11.17a5.5 5.5 0 011.83-10.742 5.5 5.5 0 011.83 10.742V17.5a.5.5 0 01-1 .5h-1.66a.5.5 0 01-1-.5v-6.33z" clip-rule="evenodd"/></svg>
            <h2>Achievements</h2>
        </div>
        <div class="additional-info">
             <ul>
            {% for a in achievements %}
                <li>{% if a.name %}<strong>{{ a.name }}:</strong> {% endif %}{{ a.description }}</li>
            {% endfor %}
            </ul>
        </div>
    </div>
    {% endif %}

    {% if languages %}
    <div class="section">
        <div class="section-header">
            <svg viewBox="0 0 20 20"><path fill="currentColor" fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM4.75 7.116a.75.75 0 011.06 0l1.47 1.47a.75.75 0 11-1.06 1.06L4.75 8.176a.75.75 0 010-1.06zM9 9a.75.75 0 000 1.5h2a.75.75 0 000-1.5H9zM7.06 7.116a.75.75 0 00-1.06 0L4.75 8.176a.75.75 0 101.06 1.06l1.25-1.25a.75.75 0 000-1.06zM13.25 7.116a.75.75 0 011.06 0l1.47 1.47a.75.75 0 01-1.06 1.06l-1.47-1.47a.75.75 0 010-1.06z" clip-rule="evenodd"/></svg>
            <h2>Languages</h2>
        </div>
        <div class="additional-info">
            <p>
            {% for lang in languages %}
                {{ lang.name }} ({{ lang.get_proficiency_display }}){% if not forloop.last %}, {% endif %}
            {% endfor %}
            </p>
        </div>
    </div>
    {% endif %}

</body>
</html>

