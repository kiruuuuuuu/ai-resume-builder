{% extends 'base.html' %}

{% block title %}Your Dashboard{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <header class="py-10">
        <h1 class="text-3xl font-bold tracking-tight text-gray-900">Latest Job Opportunities</h1>
        <p class="mt-2 text-lg text-gray-600">Here are the newest job postings, ranked by how well they match your resume.</p>
    </header>
    <div class="space-y-6">
        {% if jobs_with_scores %}
            {% for item in jobs_with_scores %}
                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 border">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                        <div>
                            <h2 class="text-xl font-bold text-gray-800">{{ item.job.title }}</h2>
                            <p class="text-gray-600 font-medium">{{ item.job.employer.company_name }} - <span class="text-sm text-gray-500">{{ item.job.location }}</span></p>
                        </div>
                        <div class="flex items-center gap-4 mt-4 sm:mt-0">
                            <div class="text-center">
                                <p class="text-2xl font-bold 
                                    {% if item.score >= 75 %}text-green-600
                                    {% elif item.score >= 50 %}text-yellow-600
                                    {% else %}text-gray-500
                                    {% endif %}">
                                    {{ item.score }}%
                                </p>
                                <p class="text-xs text-gray-500 font-medium">Match Score</p>
                            </div>
                            <a href="{% url 'jobs:job-detail' job_id=item.job.id %}" class="inline-block bg-indigo-600 text-white font-semibold py-2 px-5 rounded-lg hover:bg-indigo-700 transition-colors duration-300 whitespace-nowrap">
                                View & Apply
                            </a>
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <!-- Fallback for users without a resume or if something goes wrong -->
            {% for job in jobs %}
                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 border">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                        <div>
                            <h2 class="text-xl font-bold text-gray-800">{{ job.title }}</h2>
                            <p class="text-gray-600 font-medium">{{ job.employer.company_name }} - <span class="text-sm text-gray-500">{{ job.location }}</span></p>
                        </div>
                        <a href="{% url 'jobs:job-detail' job_id=job.id %}" class="mt-4 sm:mt-0 inline-block bg-indigo-600 text-white font-semibold py-2 px-5 rounded-lg hover:bg-indigo-700 transition-colors duration-300 whitespace-nowrap">
                            View & Apply
                        </a>
                    </div>
                </div>
            {% endfor %}
        {% endif %}

        {% if not jobs_with_scores and not jobs %}
            <div class="text-center py-16 bg-white rounded-lg border">
                <h3 class="text-xl font-medium text-gray-900">No Jobs Found</h3>
                <p class="text-gray-500 mt-2">No jobs posted yet. Please check back later!</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
